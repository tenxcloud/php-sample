(function($){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:true,dblClickExpand:true,expandSpeed:"fast",fontCss:{},nameIsHTML:false,selectedMulti:true,showIcon:true,showLine:true,showTitle:true},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:false,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:false,leaf:false}},async:{enable:false,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(e){var t=data.getRoot(e);if(!t){t={};data.setRoot(e,t)}t[e.data.key.children]=[];t.expandTriggerFlag=false;t.curSelectedList=[];t.noSelection=true;t.createdNodes=[];t.zId=0;t._ver=(new Date).getTime()},_initCache=function(e){var t=data.getCache(e);if(!t){t={};data.setCache(e,t)}t.nodes=[];t.doms=[]},_bindEvent=function(e){var t=e.treeObj,n=consts.event;t.bind(n.NODECREATED,function(t,n,a){tools.apply(e.callback.onNodeCreated,[t,n,a])});t.bind(n.CLICK,function(t,n,a,o,r){tools.apply(e.callback.onClick,[n,a,o,r])});t.bind(n.EXPAND,function(t,n,a){tools.apply(e.callback.onExpand,[t,n,a])});t.bind(n.COLLAPSE,function(t,n,a){tools.apply(e.callback.onCollapse,[t,n,a])});t.bind(n.ASYNC_SUCCESS,function(t,n,a,o){tools.apply(e.callback.onAsyncSuccess,[t,n,a,o])});t.bind(n.ASYNC_ERROR,function(t,n,a,o,r,i){tools.apply(e.callback.onAsyncError,[t,n,a,o,r,i])})},_unbindEvent=function(e){var t=e.treeObj,n=consts.event;t.unbind(n.NODECREATED).unbind(n.CLICK).unbind(n.EXPAND).unbind(n.COLLAPSE).unbind(n.ASYNC_SUCCESS).unbind(n.ASYNC_ERROR)},_eventProxy=function(e){var t=e.target,n=data.getSetting(e.data.treeId),a="",o=null,r="",i="",d=null,s=null,l=null;if(tools.eqs(e.type,"mousedown")){i="mousedown"}else if(tools.eqs(e.type,"mouseup")){i="mouseup"}else if(tools.eqs(e.type,"contextmenu")){i="contextmenu"}else if(tools.eqs(e.type,"click")){if(tools.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+consts.id.SWITCH)!==null){a=($(t).parent("li").get(0)||$(t).parentsUntil("li").parent().get(0)).id;r="switchNode"}else{l=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(l){a=($(l).parent("li").get(0)||$(l).parentsUntil("li").parent().get(0)).id;r="clickNode"}}}else if(tools.eqs(e.type,"dblclick")){i="dblclick";l=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(l){a=($(l).parent("li").get(0)||$(l).parentsUntil("li").parent().get(0)).id;r="switchNode"}}if(i.length>0&&a.length==0){l=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(l){a=($(l).parent("li").get(0)||$(l).parentsUntil("li").parent().get(0)).id}}if(a.length>0){o=data.getNodeCache(n,a);switch(r){case"switchNode":if(!o.isParent){r=""}else if(tools.eqs(e.type,"click")||tools.eqs(e.type,"dblclick")&&tools.apply(n.view.dblClickExpand,[n.treeId,o],n.view.dblClickExpand)){d=handler.onSwitchNode}else{r=""}break;case"clickNode":d=handler.onClickNode;break}}switch(i){case"mousedown":s=handler.onZTreeMousedown;break;case"mouseup":s=handler.onZTreeMouseup;break;case"dblclick":s=handler.onZTreeDblclick;break;case"contextmenu":s=handler.onZTreeContextmenu;break}var c={stop:false,node:o,nodeEventType:r,nodeEventCallback:d,treeEventType:i,treeEventCallback:s};return c},_initNode=function(e,t,n,a,o,r,i){if(!n)return;var d=data.getRoot(e),s=e.data.key.children;n.level=t;n.tId=e.treeId+"_"+ ++d.zId;n.parentTId=a?a.tId:null;if(n[s]&&n[s].length>0){if(typeof n.open=="string")n.open=tools.eqs(n.open,"true");n.open=!!n.open;n.isParent=true;n.zAsync=true}else{n.open=false;if(typeof n.isParent=="string")n.isParent=tools.eqs(n.isParent,"true");n.isParent=!!n.isParent;n.zAsync=!n.isParent}n.isFirstNode=o;n.isLastNode=r;n.getParentNode=function(){return data.getNodeCache(e,n.parentTId)};n.getPreNode=function(){return data.getPreNode(e,n)};n.getNextNode=function(){return data.getNextNode(e,n)};n.isAjaxing=false;data.fixPIdKeyValue(e,n)},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(e,t){data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){_init.afterA.push(e)},addBeforeA:function(e){_init.beforeA.push(e)},addInnerAfterA:function(e){_init.innerAfterA.push(e)},addInnerBeforeA:function(e){_init.innerBeforeA.push(e)},addInitBind:function(e){_init.bind.push(e)},addInitUnBind:function(e){_init.unbind.push(e)},addInitCache:function(e){_init.caches.push(e)},addInitNode:function(e){_init.nodes.push(e)},addInitProxy:function(e){_init.proxys.push(e)},addInitRoot:function(e){_init.roots.push(e)},addNodesData:function(e,t,n){var a=e.data.key.children;if(!t[a])t[a]=[];if(t[a].length>0){t[a][t[a].length-1].isLastNode=false;view.setNodeLineIcos(e,t[a][t[a].length-1])}t.isParent=true;t[a]=t[a].concat(n)},addSelectedNode:function(e,t){var n=data.getRoot(e);if(!data.isSelectedNode(e,t)){n.curSelectedList.push(t)}},addCreatedNode:function(e,t){if(!!e.callback.onNodeCreated||!!e.view.addDiyDom){var n=data.getRoot(e);n.createdNodes.push(t)}},addZTreeTools:function(e){_init.zTreeTools.push(e)},exSetting:function(e){$.extend(true,_setting,e)},fixPIdKeyValue:function(e,t){if(e.data.simpleData.enable){t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId}},getAfterA:function(e,t,n){for(var a=0,o=_init.afterA.length;a<o;a++){_init.afterA[a].apply(this,arguments)}},getBeforeA:function(e,t,n){for(var a=0,o=_init.beforeA.length;a<o;a++){_init.beforeA[a].apply(this,arguments)}},getInnerAfterA:function(e,t,n){for(var a=0,o=_init.innerAfterA.length;a<o;a++){_init.innerAfterA[a].apply(this,arguments)}},getInnerBeforeA:function(e,t,n){for(var a=0,o=_init.innerBeforeA.length;a<o;a++){_init.innerBeforeA[a].apply(this,arguments)}},getCache:function(e){return caches[e.treeId]},getNextNode:function(e,t){if(!t)return null;var n=e.data.key.children,a=t.parentTId?t.getParentNode():data.getRoot(e);for(var o=0,r=a[n].length-1;o<=r;o++){if(a[n][o]===t){return o==r?null:a[n][o+1]}}return null},getNodeByParam:function(e,t,n,a){if(!t||!n)return null;var o=e.data.key.children;for(var r=0,i=t.length;r<i;r++){if(t[r][n]==a){return t[r]}var d=data.getNodeByParam(e,t[r][o],n,a);if(d)return d}return null},getNodeCache:function(e,t){if(!t)return null;var n=caches[e.treeId].nodes[data.getNodeCacheId(t)];return n?n:null},getNodeName:function(e,t){var n=e.data.key.name;return""+t[n]},getNodeTitle:function(e,t){var n=e.data.key.title===""?e.data.key.name:e.data.key.title;return""+t[n]},getNodes:function(e){return data.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,n,a){if(!t||!n)return[];var o=e.data.key.children,r=[];for(var i=0,d=t.length;i<d;i++){if(t[i][n]==a){r.push(t[i])}r=r.concat(data.getNodesByParam(e,t[i][o],n,a))}return r},getNodesByParamFuzzy:function(e,t,n,a){if(!t||!n)return[];var o=e.data.key.children,r=[];a=a.toLowerCase();for(var i=0,d=t.length;i<d;i++){if(typeof t[i][n]=="string"&&t[i][n].toLowerCase().indexOf(a)>-1){r.push(t[i])}r=r.concat(data.getNodesByParamFuzzy(e,t[i][o],n,a))}return r},getNodesByFilter:function(e,t,n,a,o){if(!t)return a?null:[];var r=e.data.key.children,i=a?null:[];for(var d=0,s=t.length;d<s;d++){if(tools.apply(n,[t[d],o],false)){if(a){return t[d]}i.push(t[d])}var l=data.getNodesByFilter(e,t[d][r],n,a,o);if(a&&!!l){return l}i=a?l:i.concat(l)}return i},getPreNode:function(e,t){if(!t)return null;var n=e.data.key.children,a=t.parentTId?t.getParentNode():data.getRoot(e);for(var o=0,r=a[n].length;o<r;o++){if(a[n][o]===t){return o==0?null:a[n][o-1]}}return null},getRoot:function(e){return e?roots[e.treeId]:null},getSetting:function(e){return settings[e]},getSettings:function(){return settings},getZTreeTools:function(e){var t=this.getRoot(this.getSetting(e));return t?t.treeTools:null},initCache:function(e){for(var t=0,n=_init.caches.length;t<n;t++){_init.caches[t].apply(this,arguments)}},initNode:function(e,t,n,a,o,r){for(var i=0,d=_init.nodes.length;i<d;i++){_init.nodes[i].apply(this,arguments)}},initRoot:function(e){for(var t=0,n=_init.roots.length;t<n;t++){_init.roots[t].apply(this,arguments)}},isSelectedNode:function(e,t){var n=data.getRoot(e);for(var a=0,o=n.curSelectedList.length;a<o;a++){if(t===n.curSelectedList[a])return true}return false},removeNodeCache:function(e,t){var n=e.data.key.children;if(t[n]){for(var a=0,o=t[n].length;a<o;a++){arguments.callee(e,t[n][a])}}data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){var n=data.getRoot(e);for(var a=0,o=n.curSelectedList.length;a<o;a++){if(t===n.curSelectedList[a]||!data.getNodeCache(e,n.curSelectedList[a].tId)){n.curSelectedList.splice(a,1);a--;o--}}},setCache:function(e,t){caches[e.treeId]=t},setRoot:function(e,t){roots[e.treeId]=t},setZTreeTools:function(e,t){for(var n=0,a=_init.zTreeTools.length;n<a;n++){_init.zTreeTools[n].apply(this,arguments)}},transformToArrayFormat:function(e,t){if(!t)return[];var n=e.data.key.children,a=[];if(tools.isArray(t)){for(var o=0,r=t.length;o<r;o++){a.push(t[o]);if(t[o][n])a=a.concat(data.transformToArrayFormat(e,t[o][n]))}}else{a.push(t);if(t[n])a=a.concat(data.transformToArrayFormat(e,t[n]))}return a},transformTozTreeFormat:function(e,t){var n,a,o=e.data.simpleData.idKey,r=e.data.simpleData.pIdKey,i=e.data.key.children;if(!o||o==""||!t)return[];if(tools.isArray(t)){var d=[];var s=[];for(n=0,a=t.length;n<a;n++){s[t[n][o]]=t[n]}for(n=0,a=t.length;n<a;n++){if(s[t[n][r]]&&t[n][o]!=t[n][r]){if(!s[t[n][r]][i])s[t[n][r]][i]=[];s[t[n][r]][i].push(t[n])}else{d.push(t[n])}}return d}else{return[t]}}},event={bindEvent:function(e){for(var t=0,n=_init.bind.length;t<n;t++){_init.bind[t].apply(this,arguments)}},unbindEvent:function(e){for(var t=0,n=_init.unbind.length;t<n;t++){_init.unbind[t].apply(this,arguments)}},bindTree:function(e){var t={treeId:e.treeId},n=e.treeObj;n.bind("selectstart",function(e){var t=e.originalEvent.srcElement.nodeName.toLowerCase();return t==="input"||t==="textarea"}).css({"-moz-user-select":"-moz-none"});n.bind("click",t,event.proxy);n.bind("dblclick",t,event.proxy);n.bind("mouseover",t,event.proxy);n.bind("mouseout",t,event.proxy);n.bind("mousedown",t,event.proxy);n.bind("mouseup",t,event.proxy);n.bind("contextmenu",t,event.proxy)},unbindTree:function(e){var t=e.treeObj;t.unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(e){var t=[];for(var n=0,a=_init.proxys.length;n<a;n++){var o=_init.proxys[n].apply(this,arguments);t.push(o);if(o.stop){break}}return t},proxy:function(e){var t=data.getSetting(e.data.treeId);if(!tools.uCanDo(t,e))return true;var n=event.doProxy(e),a=true,o=false;for(var r=0,i=n.length;r<i;r++){var d=n[r];if(d.nodeEventCallback){o=true;a=d.nodeEventCallback.apply(d,[e,d.node])&&a}if(d.treeEventCallback){o=true;a=d.treeEventCallback.apply(d,[e,d.node])&&a}}return a}},handler={onSwitchNode:function(e,t){var n=data.getSetting(e.data.treeId);if(t.open){if(tools.apply(n.callback.beforeCollapse,[n.treeId,t],true)==false)return true;data.getRoot(n).expandTriggerFlag=true;view.switchNode(n,t)}else{if(tools.apply(n.callback.beforeExpand,[n.treeId,t],true)==false)return true;data.getRoot(n).expandTriggerFlag=true;view.switchNode(n,t)}return true},onClickNode:function(e,t){var n=data.getSetting(e.data.treeId),a=n.view.autoCancelSelected&&e.ctrlKey&&data.isSelectedNode(n,t)?0:n.view.autoCancelSelected&&e.ctrlKey&&n.view.selectedMulti?2:1;if(tools.apply(n.callback.beforeClick,[n.treeId,t,a],true)==false)return true;if(a===0){view.cancelPreSelectedNode(n,t)}else{view.selectNode(n,t,a===2)}n.treeObj.trigger(consts.event.CLICK,[e,n.treeId,t,a]);return true},onZTreeMousedown:function(e,t){var n=data.getSetting(e.data.treeId);if(tools.apply(n.callback.beforeMouseDown,[n.treeId,t],true)){tools.apply(n.callback.onMouseDown,[e,n.treeId,t])}return true},onZTreeMouseup:function(e,t){var n=data.getSetting(e.data.treeId);if(tools.apply(n.callback.beforeMouseUp,[n.treeId,t],true)){tools.apply(n.callback.onMouseUp,[e,n.treeId,t])}return true},onZTreeDblclick:function(e,t){var n=data.getSetting(e.data.treeId);if(tools.apply(n.callback.beforeDblClick,[n.treeId,t],true)){tools.apply(n.callback.onDblClick,[e,n.treeId,t])}return true},onZTreeContextmenu:function(e,t){var n=data.getSetting(e.data.treeId);if(tools.apply(n.callback.beforeRightClick,[n.treeId,t],true)){tools.apply(n.callback.onRightClick,[e,n.treeId,t])}return typeof n.callback.onRightClick!="function"}},tools={apply:function(e,t,n){if(typeof e=="function"){return e.apply(zt,t?t:[])}return n},canAsync:function(e,t){var n=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[n]&&t[n].length>0)},clone:function(e){if(e===null)return null;var t=e.constructor===Array?[]:{};for(var n in e){t[n]=e[n]instanceof Date?new Date(e[n].getTime()):typeof e[n]==="object"?arguments.callee(e[n]):e[n]}return t},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return Object.prototype.toString.apply(e)==="[object Array]"},getMDom:function(e,t,n){if(!t)return null;while(t&&t.id!==e.treeId){for(var a=0,o=n.length;t.tagName&&a<o;a++){if(tools.eqs(t.tagName,n[a].tagName)&&t.getAttribute(n[a].attrName)!==null){return t}}t=t.parentNode}return null},uCanDo:function(e,t){return true}},view={addNodes:function(e,t,n,a){if(e.data.keep.leaf&&t&&!t.isParent){return}if(!tools.isArray(n)){n=[n]}if(e.data.simpleData.enable){n=data.transformTozTreeFormat(e,n)}if(t){var o=$("#"+t.tId+consts.id.SWITCH),r=$("#"+t.tId+consts.id.ICON),i=$("#"+t.tId+consts.id.UL);if(!t.open){view.replaceSwitchClass(t,o,consts.folder.CLOSE);view.replaceIcoClass(t,r,consts.folder.CLOSE);t.open=false;i.css({display:"none"})}data.addNodesData(e,t,n);view.createNodes(e,t.level+1,n,t);if(!a){view.expandCollapseParentNode(e,t,true)}}else{data.addNodesData(e,data.getRoot(e),n);view.createNodes(e,0,n,null)}},appendNodes:function(e,t,n,a,o,r){if(!n)return[];var i=[],d=e.data.key.children;for(var s=0,l=n.length;s<l;s++){var c=n[s];if(o){var u=a?a:data.getRoot(e),f=u[d],p=f.length==n.length&&s==0,g=s==n.length-1;data.initNode(e,t,c,a,p,g,r);data.addNodeCache(e,c)}var v=[];if(c[d]&&c[d].length>0){v=view.appendNodes(e,t+1,c[d],c,o,r&&c.open)}if(r){view.makeDOMNodeMainBefore(i,e,c);view.makeDOMNodeLine(i,e,c);data.getBeforeA(e,c,i);view.makeDOMNodeNameBefore(i,e,c);data.getInnerBeforeA(e,c,i);view.makeDOMNodeIcon(i,e,c);data.getInnerAfterA(e,c,i);view.makeDOMNodeNameAfter(i,e,c);data.getAfterA(e,c,i);if(c.isParent&&c.open){view.makeUlHtml(e,c,i,v.join(""))}view.makeDOMNodeMainAfter(i,e,c);data.addCreatedNode(e,c)}}return i},appendParentULDom:function(e,t){var n=[],a=$("#"+t.tId),o=$("#"+t.tId+consts.id.UL),r=e.data.key.children,i=view.appendNodes(e,t.level+1,t[r],t,false,true);view.makeUlHtml(e,t,n,i.join(""));if(!a.get(0)&&!!t.parentTId){view.appendParentULDom(e,t.getParentNode());a=$("#"+t.tId)}if(o.get(0)){o.remove()}a.append(n.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,l;if(node&&!node.isParent){tools.apply(callback);return false}else if(node&&node.isAjaxing){return false}else if(tools.apply(setting.callback.beforeAsync,[setting.treeId,node],true)==false){tools.apply(callback);return false}if(node){node.isAjaxing=true;var icoObj=$("#"+node.tId+consts.id.ICON);icoObj.attr({style:"","class":consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={};for(i=0,l=setting.async.autoParam.length;node&&i<l;i++){var pKey=setting.async.autoParam[i].split("="),spKey=pKey;if(pKey.length>1){spKey=pKey[1];pKey=pKey[0]}tmpParam[spKey]=node[pKey]}if(tools.isArray(setting.async.otherParam)){for(i=0,l=setting.async.otherParam.length;i<l;i+=2){tmpParam[setting.async.otherParam[i]]=setting.async.otherParam[i+1]}}else{for(var p in setting.async.otherParam){tmpParam[p]=setting.async.otherParam[p]}}var _tmpV=data.getRoot(setting)._ver;$.ajax({contentType:setting.async.contentType,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:tmpParam,dataType:setting.async.dataType,success:function(msg){if(_tmpV!=data.getRoot(setting)._ver){return}var newNodes=[];try{if(!msg||msg.length==0){newNodes=[]}else if(typeof msg=="string"){newNodes=eval("("+msg+")")}else{newNodes=msg}}catch(err){newNodes=msg}if(node){node.isAjaxing=null;node.zAsync=true}view.setNodeLineIcos(setting,node);if(newNodes&&newNodes!==""){newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes);view.addNodes(setting,node,!!newNodes?tools.clone(newNodes):[],!!isSilent)}else{view.addNodes(setting,node,[],!!isSilent)}setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]);tools.apply(callback)},error:function(e,t,n){if(_tmpV!=data.getRoot(setting)._ver){return}if(node)node.isAjaxing=null;view.setNodeLineIcos(setting,node);setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,e,t,n])}});return true},cancelPreSelectedNode:function(e,t){var n=data.getRoot(e).curSelectedList;for(var a=0,o=n.length-1;o>=a;o--){if(!t||t===n[o]){$("#"+n[o].tId+consts.id.A).removeClass(consts.node.CURSELECTED);if(t){data.removeSelectedNode(e,t);break}}}if(!t)data.getRoot(e).curSelectedList=[]},createNodeCallback:function(e){if(!!e.callback.onNodeCreated||!!e.view.addDiyDom){var t=data.getRoot(e);while(t.createdNodes.length>0){var n=t.createdNodes.shift();tools.apply(e.view.addDiyDom,[e.treeId,n]);if(!!e.callback.onNodeCreated){e.treeObj.trigger(consts.event.NODECREATED,[e.treeId,n])}}}},createNodes:function(e,t,n,a){if(!n||n.length==0)return;var o=data.getRoot(e),r=e.data.key.children,i=!a||a.open||!!$("#"+a[r][0].tId).get(0);o.createdNodes=[];var d=view.appendNodes(e,t,n,a,true,i);if(!a){e.treeObj.append(d.join(""))}else{var s=$("#"+a.tId+consts.id.UL);if(s.get(0)){s.append(d.join(""))}}view.createNodeCallback(e)},destroy:function(e){if(!e)return;data.initCache(e);data.initRoot(e);event.unbindTree(e);event.unbindEvent(e);e.treeObj.empty()},expandCollapseNode:function(e,t,n,a,o){var r=data.getRoot(e),i=e.data.key.children;if(!t){tools.apply(o,[]);return}if(r.expandTriggerFlag){var d=o;o=function(){if(d)d();if(t.open){e.treeObj.trigger(consts.event.EXPAND,[e.treeId,t])}else{e.treeObj.trigger(consts.event.COLLAPSE,[e.treeId,t])}};r.expandTriggerFlag=false}if(!t.open&&t.isParent&&(!$("#"+t.tId+consts.id.UL).get(0)||t[i]&&t[i].length>0&&!$("#"+t[i][0].tId).get(0))){view.appendParentULDom(e,t);view.createNodeCallback(e)}if(t.open==n){tools.apply(o,[]);return}var s=$("#"+t.tId+consts.id.UL),l=$("#"+t.tId+consts.id.SWITCH),c=$("#"+t.tId+consts.id.ICON);if(t.isParent){t.open=!t.open;if(t.iconOpen&&t.iconClose){c.attr("style",view.makeNodeIcoStyle(e,t))}if(t.open){view.replaceSwitchClass(t,l,consts.folder.OPEN);view.replaceIcoClass(t,c,consts.folder.OPEN);if(a==false||e.view.expandSpeed==""){s.show();tools.apply(o,[])}else{if(t[i]&&t[i].length>0){s.slideDown(e.view.expandSpeed,o)}else{s.show();tools.apply(o,[])}}}else{view.replaceSwitchClass(t,l,consts.folder.CLOSE);view.replaceIcoClass(t,c,consts.folder.CLOSE);if(a==false||e.view.expandSpeed==""||!(t[i]&&t[i].length>0)){s.hide();tools.apply(o,[])}else{s.slideUp(e.view.expandSpeed,o)}}}else{tools.apply(o,[])}},expandCollapseParentNode:function(e,t,n,a,o){if(!t)return;if(!t.parentTId){view.expandCollapseNode(e,t,n,a,o);return}else{view.expandCollapseNode(e,t,n,a)}if(t.parentTId){view.expandCollapseParentNode(e,t.getParentNode(),n,a,o)}},expandCollapseSonNode:function(e,t,n,a,o){var r=data.getRoot(e),i=e.data.key.children,d=t?t[i]:r[i],s=t?false:a,l=data.getRoot(e).expandTriggerFlag;data.getRoot(e).expandTriggerFlag=false;if(d){for(var c=0,u=d.length;c<u;c++){if(d[c])view.expandCollapseSonNode(e,d[c],n,s)}}data.getRoot(e).expandTriggerFlag=l;view.expandCollapseNode(e,t,n,a,o)},makeDOMNodeIcon:function(e,t,n){var a=data.getNodeName(t,n),o=t.view.nameIsHTML?a:a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",n.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,n),"' style='",view.makeNodeIcoStyle(t,n),"'></span><span id='",n.tId,consts.id.SPAN,"'>",o,"</span>")},makeDOMNodeLine:function(e,t,n){e.push("<span id='",n.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,n),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e,t,n){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,n){e.push("<li id='",n.tId,"' class='",consts.className.LEVEL,n.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e,t,n){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,n){var a=data.getNodeTitle(t,n),o=view.makeNodeUrl(t,n),r=view.makeNodeFontCss(t,n),i=[];for(var d in r){i.push(d,":",r[d],";")}e.push("<a id='",n.tId,consts.id.A,"' class='",consts.className.LEVEL,n.level,"' treeNode",consts.id.A,' onclick="',n.click||"",'" ',o!=null&&o.length>0?"href='"+o+"'":""," target='",view.makeNodeTarget(n),"' style='",i.join(""),"'");if(tools.apply(t.view.showTitle,[t.treeId,n],t.view.showTitle)&&a){e.push("title='",a.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'")}e.push(">")},makeNodeFontCss:function(e,t){var n=tools.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return n&&typeof n!="function"?n:{}},makeNodeIcoClass:function(e,t){var n=["ico"];if(!t.isAjaxing){n[0]=(t.iconSkin?t.iconSkin+"_":"")+n[0];if(t.isParent){n.push(t.open?consts.folder.OPEN:consts.folder.CLOSE)}else{n.push(consts.folder.DOCU)}}return consts.className.BUTTON+" "+n.join("_")},makeNodeIcoStyle:function(e,t){var n=[];if(!t.isAjaxing){var a=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t.icon;if(a)n.push("background:url(",a,") 0 0 no-repeat;");if(e.view.showIcon==false||!tools.apply(e.view.showIcon,[e.treeId,t],true)){n.push("width:0px;height:0px;")}}return n.join("")},makeNodeLineClass:function(e,t){var n=[];if(e.view.showLine){if(t.level==0&&t.isFirstNode&&t.isLastNode){n.push(consts.line.ROOT)}else if(t.level==0&&t.isFirstNode){n.push(consts.line.ROOTS)}else if(t.isLastNode){n.push(consts.line.BOTTOM)}else{n.push(consts.line.CENTER)}}else{n.push(consts.line.NOLINE)}if(t.isParent){n.push(t.open?consts.folder.OPEN:consts.folder.CLOSE)}else{n.push(consts.folder.DOCU)}return view.makeNodeLineClassEx(t)+n.join("_")},makeNodeLineClassEx:function(e){return consts.className.BUTTON+" "+consts.className.LEVEL+e.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var n=e.data.key.url;return t[n]?t[n]:null},makeUlHtml:function(e,t,n,a){n.push("<ul id='",t.tId,consts.id.UL,"' class='",consts.className.LEVEL,t.level," ",view.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>");n.push(a);n.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(e,t){if(!t)return;var n=e.data.key.children,a=t[n];if(!a)return;for(var o=0,r=a.length;o<r;o++){data.removeNodeCache(e,a[o])}data.removeSelectedNode(e);delete t[n];if(!e.data.keep.parent){t.isParent=false;t.open=false;var i=$("#"+t.tId+consts.id.SWITCH),d=$("#"+t.tId+consts.id.ICON);view.replaceSwitchClass(t,i,consts.folder.DOCU);view.replaceIcoClass(t,d,consts.folder.DOCU);$("#"+t.tId+consts.id.UL).remove()}else{$("#"+t.tId+consts.id.UL).empty()}},setFirstNode:function(e,t){var n=e.data.key.children,a=t[n].length;if(a>0){t[n][0].isFirstNode=true}},setLastNode:function(e,t){var n=e.data.key.children,a=t[n].length;if(a>0){t[n][a-1].isLastNode=true}},removeNode:function(e,t){var n=data.getRoot(e),a=e.data.key.children,o=t.parentTId?t.getParentNode():n;t.isFirstNode=false;t.isLastNode=false;t.getPreNode=function(){return null};t.getNextNode=function(){return null};if(!data.getNodeCache(e,t.tId)){return}$("#"+t.tId).remove();data.removeNodeCache(e,t);data.removeSelectedNode(e,t);for(var r=0,i=o[a].length;r<i;r++){if(o[a][r].tId==t.tId){o[a].splice(r,1);break}}view.setFirstNode(e,o);view.setLastNode(e,o);var d,s,l,c=o[a].length;if(!e.data.keep.parent&&c==0){o.isParent=false;o.open=false;d=$("#"+o.tId+consts.id.UL);s=$("#"+o.tId+consts.id.SWITCH);l=$("#"+o.tId+consts.id.ICON);view.replaceSwitchClass(o,s,consts.folder.DOCU);view.replaceIcoClass(o,l,consts.folder.DOCU);d.css("display","none")}else if(e.view.showLine&&c>0){var u=o[a][c-1];d=$("#"+u.tId+consts.id.UL);s=$("#"+u.tId+consts.id.SWITCH);l=$("#"+u.tId+consts.id.ICON);if(o==n){if(o[a].length==1){view.replaceSwitchClass(u,s,consts.line.ROOT)}else{var f=$("#"+o[a][0].tId+consts.id.SWITCH);view.replaceSwitchClass(o[a][0],f,consts.line.ROOTS);view.replaceSwitchClass(u,s,consts.line.BOTTOM)}}else{view.replaceSwitchClass(u,s,consts.line.BOTTOM)}d.removeClass(consts.line.LINE)}},replaceIcoClass:function(e,t,n){if(!t||e.isAjaxing)return;var a=t.attr("class");if(a==undefined)return;var o=a.split("_");switch(n){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:o[o.length-1]=n;break}t.attr("class",o.join("_"))},replaceSwitchClass:function(e,t,n){if(!t)return;var a=t.attr("class");if(a==undefined)return;var o=a.split("_");switch(n){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:o[0]=view.makeNodeLineClassEx(e)+n;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:o[1]=n;break}t.attr("class",o.join("_"));if(n!==consts.folder.DOCU){t.removeAttr("disabled")}else{t.attr("disabled","disabled")}},selectNode:function(e,t,n){if(!n){view.cancelPreSelectedNode(e)}$("#"+t.tId+consts.id.A).addClass(consts.node.CURSELECTED);data.addSelectedNode(e,t)},setNodeFontCss:function(e,t){var n=$("#"+t.tId+consts.id.A),a=view.makeNodeFontCss(e,t);if(a){n.css(a)}},setNodeLineIcos:function(e,t){if(!t)return;var n=$("#"+t.tId+consts.id.SWITCH),a=$("#"+t.tId+consts.id.UL),o=$("#"+t.tId+consts.id.ICON),r=view.makeUlLineClass(e,t);if(r.length==0){a.removeClass(consts.line.LINE)}else{a.addClass(r)}n.attr("class",view.makeNodeLineClass(e,t));if(t.isParent){n.removeAttr("disabled")}else{n.attr("disabled","disabled")}o.removeAttr("style");o.attr("style",view.makeNodeIcoStyle(e,t));o.attr("class",view.makeNodeIcoClass(e,t))},setNodeName:function(e,t){var n=data.getNodeTitle(e,t),a=$("#"+t.tId+consts.id.SPAN);a.empty();if(e.view.nameIsHTML){a.html(data.getNodeName(e,t))}else{a.text(data.getNodeName(e,t))}if(tools.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle)){var o=$("#"+t.tId+consts.id.A);o.attr("title",!n?"":n)}},setNodeTarget:function(e){var t=$("#"+e.tId+consts.id.A);t.attr("target",view.makeNodeTarget(e))},setNodeUrl:function(e,t){var n=$("#"+t.tId+consts.id.A),a=view.makeNodeUrl(e,t);if(a==null||a.length==0){n.removeAttr("href")}else{n.attr("href",a)}},switchNode:function(e,t){if(t.open||!tools.canAsync(e,t)){view.expandCollapseNode(e,t,!t.open)}else if(e.async.enable){if(!view.asyncNode(e,t)){view.expandCollapseNode(e,t,!t.open);return}}else if(t){view.expandCollapseNode(e,t,!t.open)}}};$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(e){var t=data.getZTreeTools(e);return t?t:null},destroy:function(e){if(!!e&&e.length>0){view.destroy(data.getSetting(e))}else{for(var t in settings){view.destroy(settings[t])}}},init:function(e,t,n){var a=tools.clone(_setting);$.extend(true,a,t);a.treeId=e.attr("id");a.treeObj=e;a.treeObj.empty();settings[a.treeId]=a;if(typeof document.body.style.maxHeight==="undefined"){a.view.expandSpeed=""}data.initRoot(a);var o=data.getRoot(a),r=a.data.key.children;n=n?tools.clone(tools.isArray(n)?n:[n]):[];if(a.data.simpleData.enable){o[r]=data.transformTozTreeFormat(a,n)}else{o[r]=n}data.initCache(a);event.unbindTree(a);event.bindTree(a);event.unbindEvent(a);event.bindEvent(a);var i={setting:a,addNodes:function(e,t,n){if(!t)return null;if(!e)e=null;if(e&&!e.isParent&&a.data.keep.leaf)return null;var o=tools.clone(tools.isArray(t)?t:[t]);function r(){view.addNodes(a,e,o,n==true)}if(tools.canAsync(a,e)){view.asyncNode(a,e,n,r)}else{r()}return o},cancelSelectedNode:function(e){view.cancelPreSelectedNode(this.setting,e)},destroy:function(){view.destroy(this.setting)},expandAll:function(e){e=!!e;view.expandCollapseSonNode(this.setting,null,e,true);return e},expandNode:function(e,t,n,o,r){if(!e||!e.isParent)return null;if(t!==true&&t!==false){t=!e.open}r=!!r;if(r&&t&&tools.apply(a.callback.beforeExpand,[a.treeId,e],true)==false){return null}else if(r&&!t&&tools.apply(a.callback.beforeCollapse,[a.treeId,e],true)==false){return null}if(t&&e.parentTId){view.expandCollapseParentNode(this.setting,e.getParentNode(),t,false)}if(t===e.open&&!n){return null}data.getRoot(a).expandTriggerFlag=r;if(n){view.expandCollapseSonNode(this.setting,e,t,true,function(){if(o!==false){try{$("#"+e.tId).focus().blur()}catch(t){}}})}else{e.open=!t;view.switchNode(this.setting,e);if(o!==false){try{$("#"+e.tId).focus().blur()}catch(i){}}}return t},getNodes:function(){return data.getNodes(this.setting)},getNodeByParam:function(e,t,n){if(!e)return null;return data.getNodeByParam(this.setting,n?n[this.setting.data.key.children]:data.getNodes(this.setting),e,t)},getNodeByTId:function(e){return data.getNodeCache(this.setting,e)},getNodesByParam:function(e,t,n){if(!e)return null;return data.getNodesByParam(this.setting,n?n[this.setting.data.key.children]:data.getNodes(this.setting),e,t)},getNodesByParamFuzzy:function(e,t,n){if(!e)return null;return data.getNodesByParamFuzzy(this.setting,n?n[this.setting.data.key.children]:data.getNodes(this.setting),e,t)},getNodesByFilter:function(e,t,n,a){t=!!t;if(!e||typeof e!="function")return t?null:[];return data.getNodesByFilter(this.setting,n?n[this.setting.data.key.children]:data.getNodes(this.setting),e,t,a)},getNodeIndex:function(e){if(!e)return null;var t=a.data.key.children,n=e.parentTId?e.getParentNode():data.getRoot(this.setting);for(var o=0,r=n[t].length;o<r;o++){if(n[t][o]==e)return o}return-1},getSelectedNodes:function(){var e=[],t=data.getRoot(this.setting).curSelectedList;for(var n=0,a=t.length;n<a;n++){e.push(t[n])}return e},isSelectedNode:function(e){return data.isSelectedNode(this.setting,e)},reAsyncChildNodes:function(e,t,n){if(!this.setting.async.enable)return;var o=!e;if(o){e=data.getRoot(this.setting)}if(t=="refresh"){var r=this.setting.data.key.children;for(var i=0,d=e[r]?e[r].length:0;i<d;i++){data.removeNodeCache(a,e[r][i])}data.removeSelectedNode(a);e[r]=[];if(o){this.setting.treeObj.empty()}else{var s=$("#"+e.tId+consts.id.UL);s.empty()}}view.asyncNode(this.setting,o?null:e,!!n)},refresh:function(){this.setting.treeObj.empty();var e=data.getRoot(this.setting),t=e[this.setting.data.key.children];data.initRoot(this.setting);e[this.setting.data.key.children]=t;data.initCache(this.setting);view.createNodes(this.setting,0,e[this.setting.data.key.children])},removeChildNodes:function(e){if(!e)return null;
var t=a.data.key.children,n=e[t];view.removeChildNodes(a,e);return n?n:null},removeNode:function(e,t){if(!e)return;t=!!t;if(t&&tools.apply(a.callback.beforeRemove,[a.treeId,e],true)==false)return;view.removeNode(a,e);if(t){this.setting.treeObj.trigger(consts.event.REMOVE,[a.treeId,e])}},selectNode:function(e,t){if(!e)return;if(tools.uCanDo(this.setting)){t=a.view.selectedMulti&&t;if(e.parentTId){view.expandCollapseParentNode(this.setting,e.getParentNode(),true,false,function(){try{$("#"+e.tId).focus().blur()}catch(t){}})}else{try{$("#"+e.tId).focus().blur()}catch(n){}}view.selectNode(this.setting,e,t)}},transformTozTreeNodes:function(e){return data.transformTozTreeFormat(this.setting,e)},transformToArray:function(e){return data.transformToArrayFormat(this.setting,e)},updateNode:function(e,t){if(!e)return;var n=$("#"+e.tId);if(n.get(0)&&tools.uCanDo(this.setting)){view.setNodeName(this.setting,e);view.setNodeTarget(e);view.setNodeUrl(this.setting,e);view.setNodeLineIcos(this.setting,e);view.setNodeFontCss(this.setting,e)}}};o.treeTools=i;data.setZTreeTools(a,i);if(o[r]&&o[r].length>0){view.createNodes(a,0,o[r])}else if(a.async.enable&&a.async.url&&a.async.url!==""){view.asyncNode(a)}return i}};var zt=$.fn.zTree,consts=zt.consts})(jQuery);(function(e){var t={event:{DRAG:"ztree_drag",DROP:"ztree_drop",REMOVE:"ztree_remove",RENAME:"ztree_rename"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},n={edit:{enable:false,editNameSelectAll:false,showRemoveBtn:true,showRenameBtn:true,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:false,isCopy:true,isMove:true,prev:true,next:true,inner:true,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDrop:null,onRename:null}},a=function(e){var t=T.getRoot(e);t.curEditNode=null;t.curEditInput=null;t.curHoverNode=null;t.dragFlag=0;t.dragNodeShowBefore=[];t.dragMaskList=new Array;t.showHoverDom=true},o=function(e){},r=function(e){var t=e.treeObj;var n=h.event;t.bind(n.RENAME,function(t,n,a){m.apply(e.callback.onRename,[t,n,a])});t.bind(n.REMOVE,function(t,n,a){m.apply(e.callback.onRemove,[t,n,a])});t.bind(n.DRAG,function(t,n,a,o){m.apply(e.callback.onDrag,[n,a,o])});t.bind(n.DROP,function(t,n,a,o,r,i,d){m.apply(e.callback.onDrop,[n,a,o,r,i,d])})},i=function(e){var t=e.treeObj;var n=h.event;t.unbind(n.RENAME);t.unbind(n.REMOVE);t.unbind(n.DRAG);t.unbind(n.DROP)},d=function(e){var t=e.target,n=T.getSetting(e.data.treeId),a=e.relatedTarget,o="",r=null,i="",d="",s=null,l=null,c=null;if(m.eqs(e.type,"mouseover")){c=m.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+h.id.A}]);if(c){o=c.parentNode.id;i="hoverOverNode"}}else if(m.eqs(e.type,"mouseout")){c=m.getMDom(n,a,[{tagName:"a",attrName:"treeNode"+h.id.A}]);if(!c){o="remove";i="hoverOutNode"}}else if(m.eqs(e.type,"mousedown")){c=m.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+h.id.A}]);if(c){o=c.parentNode.id;i="mousedownNode"}}if(o.length>0){r=T.getNodeCache(n,o);switch(i){case"mousedownNode":s=f.onMousedownNode;break;case"hoverOverNode":s=f.onHoverOverNode;break;case"hoverOutNode":s=f.onHoverOutNode;break}}var u={stop:false,node:r,nodeEventType:i,nodeEventCallback:s,treeEventType:d,treeEventCallback:l};return u},s=function(e,t,n,a,o,r,i){if(!n)return;n.isHover=false;n.editNameFlag=false},l=function(t,n){n.cancelEditName=function(e){var n=T.getRoot(t),a=t.data.key.name,o=n.curEditNode;if(!n.curEditNode)return;I.cancelCurEditNode(t,e?e:o[a])};n.copyNode=function(e,n,a,o){if(!n)return null;if(e&&!e.isParent&&t.data.keep.leaf&&a===h.move.TYPE_INNER)return null;var r=m.clone(n);if(!e){e=null;a=h.move.TYPE_INNER}if(a==h.move.TYPE_INNER){function i(){I.addNodes(t,e,[r],o)}if(m.canAsync(t,e)){I.asyncNode(t,e,o,i)}else{i()}}else{I.addNodes(t,e.parentNode,[r],o);I.moveNode(t,e,r,a,false,o)}return r};n.editName=function(e){if(!e||!e.tId||e!==T.getNodeCache(t,e.tId))return;if(e.parentTId)I.expandCollapseParentNode(t,e.getParentNode(),true);I.editNode(t,e)};n.moveNode=function(n,a,o,r){if(!a)return a;if(n&&!n.isParent&&t.data.keep.leaf&&o===h.move.TYPE_INNER){return null}else if(n&&(a.parentTId==n.tId&&o==h.move.TYPE_INNER||e("#"+a.tId).find("#"+n.tId).length>0)){return null}else if(!n){n=null}function i(){I.moveNode(t,n,a,o,false,r)}if(m.canAsync(t,n)&&o===h.move.TYPE_INNER){I.asyncNode(t,n,r,i)}else{i()}return a};n.setEditable=function(e){t.edit.enable=e;return this.refresh()}},c={setSonNodeLevel:function(e,t,n){if(!n)return;var a=e.data.key.children;n.level=t?t.level+1:0;if(!n[a])return;for(var o=0,r=n[a].length;o<r;o++){if(n[a][o])T.setSonNodeLevel(e,n,n[a][o])}}},u={},f={onHoverOverNode:function(e,t){var n=T.getSetting(e.data.treeId),a=T.getRoot(n);if(a.curHoverNode!=t){f.onHoverOutNode(e)}a.curHoverNode=t;I.addHoverDom(n,t)},onHoverOutNode:function(e,t){var n=T.getSetting(e.data.treeId),a=T.getRoot(n);if(a.curHoverNode&&!T.isSelectedNode(n,a.curHoverNode)){I.removeTreeDom(n,a.curHoverNode);a.curHoverNode=null}},onMousedownNode:function(n,a){var o,r,i=T.getSetting(n.data.treeId),d=T.getRoot(i);if(n.button==2||!i.edit.enable||!i.edit.drag.isCopy&&!i.edit.drag.isMove)return true;var s=n.target,l=T.getRoot(i).curSelectedList,c=[];if(!T.isSelectedNode(i,a)){c=[a]}else{for(o=0,r=l.length;o<r;o++){if(l[o].editNameFlag&&m.eqs(s.tagName,"input")&&s.getAttribute("treeNode"+h.id.INPUT)!==null){return true}c.push(l[o]);if(c[0].parentTId!==l[o].parentTId){c=[a];break}}}I.editNodeBlur=true;I.cancelCurEditNode(i,null,true);var u=e(document),f,p,g,v=false,N=i,y,b,E=null,C=null,w=null,k=h.move.TYPE_INNER,P=n.clientX,O=n.clientY,R=(new Date).getTime();if(m.uCanDo(i)){u.bind("mousemove",S)}function S(n){if(d.dragFlag==0&&Math.abs(P-n.clientX)<i.edit.drag.minMoveSize&&Math.abs(O-n.clientY)<i.edit.drag.minMoveSize){return true}var a,o,r,s,l,S=i.data.key.children;e("body").css("cursor","pointer");if(d.dragFlag==0){if(m.apply(i.callback.beforeDrag,[i.treeId,c],true)==false){_(n);return true}for(a=0,o=c.length;a<o;a++){if(a==0){d.dragNodeShowBefore=[]}r=c[a];if(r.isParent&&r.open){I.expandCollapseNode(i,r,!r.open);d.dragNodeShowBefore[r.tId]=true}else{d.dragNodeShowBefore[r.tId]=false}}d.dragFlag=1;d.showHoverDom=false;m.showIfameMask(i,true);var A=true,D=-1;if(c.length>1){var L=c[0].parentTId?c[0].getParentNode()[S]:T.getNodes(i);l=[];for(a=0,o=L.length;a<o;a++){if(d.dragNodeShowBefore[L[a].tId]!==undefined){if(A&&D>-1&&D+1!==a){A=false}l.push(L[a]);D=a}if(c.length===l.length){c=l;break}}}if(A){y=c[0].getPreNode();b=c[c.length-1].getNextNode()}f=e("<ul class='zTreeDragUL'></ul>");for(a=0,o=c.length;a<o;a++){r=c[a];r.editNameFlag=false;I.selectNode(i,r,a>0);I.removeTreeDom(i,r);s=e("<li id='"+r.tId+"_tmp'></li>");s.append(e("#"+r.tId+h.id.A).clone());s.css("padding","0");s.children("#"+r.tId+h.id.A).removeClass(h.node.CURSELECTED);f.append(s);if(a==i.edit.drag.maxShowNodeNum-1){s=e("<li id='"+r.tId+"_moretmp'><a>  ...  </a></li>");f.append(s);break}}f.attr("id",c[0].tId+h.id.UL+"_tmp");f.addClass(i.treeObj.attr("class"));f.appendTo("body");p=e("<span class='tmpzTreeMove_arrow'></span>");p.attr("id","zTreeMove_arrow_tmp");p.appendTo("body");i.treeObj.trigger(h.event.DRAG,[n,i.treeId,c])}if(d.dragFlag==1){if(g&&p.attr("id")==n.target.id&&w&&n.clientX+u.scrollLeft()+2>e("#"+w+h.id.A,g).offset().left){var x=e("#"+w+h.id.A,g);n.target=x.length>0?x.get(0):n.target}else if(g){g.removeClass(h.node.TMPTARGET_TREE);if(w)e("#"+w+h.id.A,g).removeClass(h.node.TMPTARGET_NODE+"_"+h.move.TYPE_PREV).removeClass(h.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(h.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)}g=null;w=null;v=false;N=i;var M=T.getSettings();for(var j in M){if(M[j].treeId&&M[j].edit.enable&&M[j].treeId!=i.treeId&&(n.target.id==M[j].treeId||e(n.target).parents("#"+M[j].treeId).length>0)){v=true;N=M[j]}}var U=u.scrollTop(),z=u.scrollLeft(),B=N.treeObj.offset(),F=N.treeObj.get(0).scrollHeight,Y=N.treeObj.get(0).scrollWidth,$=n.clientY+U-B.top,H=N.treeObj.height()+B.top-n.clientY-U,V=n.clientX+z-B.left,K=N.treeObj.width()+B.left-n.clientX-z,q=$<i.edit.drag.borderMax&&$>i.edit.drag.borderMin,W=H<i.edit.drag.borderMax&&H>i.edit.drag.borderMin,X=V<i.edit.drag.borderMax&&V>i.edit.drag.borderMin,G=K<i.edit.drag.borderMax&&K>i.edit.drag.borderMin,Z=$>i.edit.drag.borderMin&&H>i.edit.drag.borderMin&&V>i.edit.drag.borderMin&&K>i.edit.drag.borderMin,Q=q&&N.treeObj.scrollTop()<=0,J=W&&N.treeObj.scrollTop()+N.treeObj.height()+10>=F,et=X&&N.treeObj.scrollLeft()<=0,tt=G&&N.treeObj.scrollLeft()+N.treeObj.width()+10>=Y;if(n.target.id&&N.treeObj.find("#"+n.target.id).length>0){var nt=n.target;while(nt&&nt.tagName&&!m.eqs(nt.tagName,"li")&&nt.id!=N.treeId){nt=nt.parentNode}var at=true;for(a=0,o=c.length;a<o;a++){r=c[a];if(nt.id===r.tId){at=false;break}else if(e("#"+r.tId).find("#"+nt.id).length>0){at=false;break}}if(at){if(n.target.id&&(n.target.id==nt.id+h.id.A||e(n.target).parents("#"+nt.id+h.id.A).length>0)){g=e(nt);w=nt.id}}}r=c[0];if(Z&&(n.target.id==N.treeId||e(n.target).parents("#"+N.treeId).length>0)){if(!g&&(n.target.id==N.treeId||Q||J||et||tt)&&(v||!v&&r.parentTId)){g=N.treeObj}if(q){N.treeObj.scrollTop(N.treeObj.scrollTop()-10)}else if(W){N.treeObj.scrollTop(N.treeObj.scrollTop()+10)}if(X){N.treeObj.scrollLeft(N.treeObj.scrollLeft()-10)}else if(G){N.treeObj.scrollLeft(N.treeObj.scrollLeft()+10)}if(g&&g!=N.treeObj&&g.offset().left<N.treeObj.offset().left){N.treeObj.scrollLeft(N.treeObj.scrollLeft()+g.offset().left-N.treeObj.offset().left)}}f.css({top:n.clientY+U+3+"px",left:n.clientX+z+3+"px"});var ot=0;var rt=0;if(g&&g.attr("id")!=N.treeId){var it=w==null?null:T.getNodeCache(N,w),dt=n.ctrlKey&&i.edit.drag.isMove&&i.edit.drag.isCopy||!i.edit.drag.isMove&&i.edit.drag.isCopy,st=!!(y&&w===y.tId),lt=!!(b&&w===b.tId),ct=r.parentTId&&r.parentTId==w,ut=(dt||!lt)&&m.apply(N.edit.drag.prev,[N.treeId,c,it],!!N.edit.drag.prev),ft=(dt||!st)&&m.apply(N.edit.drag.next,[N.treeId,c,it],!!N.edit.drag.next),pt=(dt||!ct)&&!(N.data.keep.leaf&&!it.isParent)&&m.apply(N.edit.drag.inner,[N.treeId,c,it],!!N.edit.drag.inner);if(!ut&&!ft&&!pt){g=null;w="";k=h.move.TYPE_INNER;p.css({display:"none"});if(window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer);window.zTreeMoveTargetNodeTId=null}}else{var gt=e("#"+w+h.id.A,g),vt=it.isLastNode?null:e("#"+it.getNextNode().tId+h.id.A,g.next()),Nt=gt.offset().top,mt=gt.offset().left,ht=ut?pt?.25:ft?.5:1:-1,It=ft?pt?.75:ut?.5:0:-1,Tt=(n.clientY+U-Nt)/gt.height();if((ht==1||Tt<=ht&&Tt>=-.2)&&ut){ot=1-p.width();rt=Nt-p.height()/2;k=h.move.TYPE_PREV}else if((It==0||Tt>=It&&Tt<=1.2)&&ft){ot=1-p.width();rt=vt==null||it.isParent&&it.open?Nt+gt.height()-p.height()/2:vt.offset().top-p.height()/2;k=h.move.TYPE_NEXT}else{ot=5-p.width();rt=Nt;k=h.move.TYPE_INNER}p.css({display:"block",top:rt+"px",left:mt+ot+"px"});gt.addClass(h.node.TMPTARGET_NODE+"_"+k);if(E!=w||C!=k){R=(new Date).getTime()}if(it&&it.isParent&&k==h.move.TYPE_INNER){var yt=true;if(window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==it.tId){clearTimeout(window.zTreeMoveTimer);window.zTreeMoveTargetNodeTId=null}else if(window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===it.tId){yt=false}if(yt){window.zTreeMoveTimer=setTimeout(function(){if(k!=h.move.TYPE_INNER)return;if(it&&it.isParent&&!it.open&&(new Date).getTime()-R>N.edit.drag.autoOpenTime&&m.apply(N.callback.beforeDragOpen,[N.treeId,it],true)){I.switchNode(N,it);if(N.edit.drag.autoExpandTrigger){N.treeObj.trigger(h.event.EXPAND,[N.treeId,it])}}},N.edit.drag.autoOpenTime+50);window.zTreeMoveTargetNodeTId=it.tId}}}}else{k=h.move.TYPE_INNER;if(g&&m.apply(N.edit.drag.inner,[N.treeId,c,null],!!N.edit.drag.inner)){g.addClass(h.node.TMPTARGET_TREE)}else{g=null}p.css({display:"none"});if(window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer);window.zTreeMoveTargetNodeTId=null}}E=w;C=k}return false}u.bind("mouseup",_);function _(n){if(window.zTreeMoveTimer){clearTimeout(window.zTreeMoveTimer);window.zTreeMoveTargetNodeTId=null}E=null;C=null;u.unbind("mousemove",S);u.unbind("mouseup",_);u.unbind("selectstart",A);e("body").css("cursor","auto");if(g){g.removeClass(h.node.TMPTARGET_TREE);if(w)e("#"+w+h.id.A,g).removeClass(h.node.TMPTARGET_NODE+"_"+h.move.TYPE_PREV).removeClass(h.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(h.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)}m.showIfameMask(i,false);d.showHoverDom=true;if(d.dragFlag==0)return;d.dragFlag=0;var a,o,r;for(a=0,o=c.length;a<o;a++){r=c[a];if(r.isParent&&d.dragNodeShowBefore[r.tId]&&!r.open){I.expandCollapseNode(i,r,!r.open);delete d.dragNodeShowBefore[r.tId]}}if(f)f.remove();if(p)p.remove();var s=n.ctrlKey&&i.edit.drag.isMove&&i.edit.drag.isCopy||!i.edit.drag.isMove&&i.edit.drag.isCopy;if(!s&&g&&w&&c[0].parentTId&&w==c[0].parentTId&&k==h.move.TYPE_INNER){g=null}if(g){var l=w==null?null:T.getNodeCache(N,w);if(m.apply(i.callback.beforeDrop,[N.treeId,c,l,k,s],true)==false)return;var y=s?m.clone(c):c;function b(){if(v){if(!s){for(var t=0,a=c.length;t<a;t++){I.removeNode(i,c[t])}}if(k==h.move.TYPE_INNER){I.addNodes(N,l,y)}else{I.addNodes(N,l.getParentNode(),y);if(k==h.move.TYPE_PREV){for(t=0,a=y.length;t<a;t++){I.moveNode(N,l,y[t],k,false)}}else{for(t=-1,a=y.length-1;t<a;a--){I.moveNode(N,l,y[a],k,false)}}}}else{if(s&&k==h.move.TYPE_INNER){I.addNodes(N,l,y)}else{if(s){I.addNodes(N,l.getParentNode(),y)}if(k!=h.move.TYPE_NEXT){for(t=0,a=y.length;t<a;t++){I.moveNode(N,l,y[t],k,false)}}else{for(t=-1,a=y.length-1;t<a;a--){I.moveNode(N,l,y[a],k,false)}}}}for(t=0,a=y.length;t<a;t++){I.selectNode(N,y[t],t>0)}e("#"+y[0].tId).focus().blur();i.treeObj.trigger(h.event.DROP,[n,N.treeId,y,l,k,s])}if(k==h.move.TYPE_INNER&&m.canAsync(N,l)){I.asyncNode(N,l,false,b)}else{b()}}else{for(a=0,o=c.length;a<o;a++){I.selectNode(N,c[a],a>0)}i.treeObj.trigger(h.event.DROP,[n,i.treeId,c,null,null,null])}}u.bind("selectstart",A);function A(){return false}if(n.preventDefault){n.preventDefault()}return true}},p={getAbs:function(e){var t=e.getBoundingClientRect();return[t.left,t.top]},inputFocus:function(e){if(e.get(0)){e.focus();m.setCursorPosition(e.get(0),e.val().length)}},inputSelect:function(e){if(e.get(0)){e.focus();e.select()}},setCursorPosition:function(e,t){if(e.setSelectionRange){e.focus();e.setSelectionRange(t,t)}else if(e.createTextRange){var n=e.createTextRange();n.collapse(true);n.moveEnd("character",t);n.moveStart("character",t);n.select()}},showIfameMask:function(t,n){var a=T.getRoot(t);while(a.dragMaskList.length>0){a.dragMaskList[0].remove();a.dragMaskList.shift()}if(n){var o=e("iframe");for(var r=0,i=o.length;r<i;r++){var d=o.get(r),s=m.getAbs(d),l=e("<div id='zTreeMask_"+r+"' class='zTreeMask' style='top:"+s[1]+"px; left:"+s[0]+"px; width:"+d.offsetWidth+"px; height:"+d.offsetHeight+"px;'></div>");l.appendTo("body");a.dragMaskList.push(l)}}}},g={addEditBtn:function(t,n){if(n.editNameFlag||e("#"+n.tId+h.id.EDIT).length>0){return}if(!m.apply(t.edit.showRenameBtn,[t.treeId,n],t.edit.showRenameBtn)){return}var a=e("#"+n.tId+h.id.A),o="<span class='"+h.className.BUTTON+" edit' id='"+n.tId+h.id.EDIT+"' title='"+m.apply(t.edit.renameTitle,[t.treeId,n],t.edit.renameTitle)+"' treeNode"+h.id.EDIT+" style='display:none;'></span>";a.append(o);e("#"+n.tId+h.id.EDIT).bind("click",function(){if(!m.uCanDo(t)||m.apply(t.callback.beforeEditName,[t.treeId,n],true)==false)return false;I.editNode(t,n);return false}).show()},addRemoveBtn:function(t,n){if(n.editNameFlag||e("#"+n.tId+h.id.REMOVE).length>0){return}if(!m.apply(t.edit.showRemoveBtn,[t.treeId,n],t.edit.showRemoveBtn)){return}var a=e("#"+n.tId+h.id.A),o="<span class='"+h.className.BUTTON+" remove' id='"+n.tId+h.id.REMOVE+"' title='"+m.apply(t.edit.removeTitle,[t.treeId,n],t.edit.removeTitle)+"' treeNode"+h.id.REMOVE+" style='display:none;'></span>";a.append(o);e("#"+n.tId+h.id.REMOVE).bind("click",function(){if(!m.uCanDo(t)||m.apply(t.callback.beforeRemove,[t.treeId,n],true)==false)return false;I.removeNode(t,n);t.treeObj.trigger(h.event.REMOVE,[t.treeId,n]);return false}).bind("mousedown",function(e){return true}).show()},addHoverDom:function(e,t){if(T.getRoot(e).showHoverDom){t.isHover=true;if(e.edit.enable){I.addEditBtn(e,t);I.addRemoveBtn(e,t)}m.apply(e.view.addHoverDom,[e.treeId,t])}},cancelCurEditNode:function(t,n){var a=T.getRoot(t),o=t.data.key.name,r=a.curEditNode;if(r){var i=a.curEditInput;var d=n?n:i.val();if(!n&&m.apply(t.callback.beforeRename,[t.treeId,r,d],true)===false){return false}else{r[o]=d?d:i.val();if(!n){t.treeObj.trigger(h.event.RENAME,[t.treeId,r])}}var s=e("#"+r.tId+h.id.A);s.removeClass(h.node.CURSELECTED_EDIT);i.unbind();I.setNodeName(t,r);r.editNameFlag=false;a.curEditNode=null;a.curEditInput=null;I.selectNode(t,r,false)}a.noSelection=true;return true},editNode:function(t,n){var a=T.getRoot(t);I.editNodeBlur=false;if(T.isSelectedNode(t,n)&&a.curEditNode==n&&n.editNameFlag){setTimeout(function(){m.inputFocus(a.curEditInput)},0);return}var o=t.data.key.name;n.editNameFlag=true;I.removeTreeDom(t,n);I.cancelCurEditNode(t);I.selectNode(t,n,false);e("#"+n.tId+h.id.SPAN).html("<input type=text class='rename' id='"+n.tId+h.id.INPUT+"' treeNode"+h.id.INPUT+" >");var r=e("#"+n.tId+h.id.INPUT);r.attr("value",n[o]);if(t.edit.editNameSelectAll){m.inputSelect(r)}else{m.inputFocus(r)}r.bind("blur",function(e){if(!I.editNodeBlur){I.cancelCurEditNode(t)}}).bind("keydown",function(e){if(e.keyCode=="13"){I.editNodeBlur=true;I.cancelCurEditNode(t,null,true)}else if(e.keyCode=="27"){I.cancelCurEditNode(t,n[o])}}).bind("click",function(e){return false}).bind("dblclick",function(e){return false});e("#"+n.tId+h.id.A).addClass(h.node.CURSELECTED_EDIT);a.curEditInput=r;a.noSelection=false;a.curEditNode=n},moveNode:function(t,n,a,o,r,i){var d=T.getRoot(t),s=t.data.key.children;if(n==a)return;if(t.data.keep.leaf&&n&&!n.isParent&&o==h.move.TYPE_INNER)return;var l=a.parentTId?a.getParentNode():d,c=n===null||n==d;if(c&&n===null)n=d;if(c)o=h.move.TYPE_INNER;var u=n.parentTId?n.getParentNode():d;if(o!=h.move.TYPE_PREV&&o!=h.move.TYPE_NEXT){o=h.move.TYPE_INNER}if(o==h.move.TYPE_INNER){if(c){a.parentTId=null}else{if(!n.isParent){n.isParent=true;n.open=!!n.open;I.setNodeLineIcos(t,n)}a.parentTId=n.tId}}var f,p;if(c){f=t.treeObj;p=f}else{if(!i&&o==h.move.TYPE_INNER){I.expandCollapseNode(t,n,true,false)}else if(!i){I.expandCollapseNode(t,n.getParentNode(),true,false)}f=e("#"+n.tId);p=e("#"+n.tId+h.id.UL);if(!!f.get(0)&&!p.get(0)){var g=[];I.makeUlHtml(t,n,g,"");f.append(g.join(""))}p=e("#"+n.tId+h.id.UL)}var v=e("#"+a.tId);if(!v.get(0)){v=I.appendNodes(t,a.level,[a],null,false,true).join("")}else if(!f.get(0)){v.remove()}if(p.get(0)&&o==h.move.TYPE_INNER){p.append(v)}else if(f.get(0)&&o==h.move.TYPE_PREV){f.before(v)}else if(f.get(0)&&o==h.move.TYPE_NEXT){f.after(v)}var N,m,y=-1,b=0,E=null,C=null,w=a.level;if(a.isFirstNode){y=0;if(l[s].length>1){E=l[s][1];E.isFirstNode=true}}else if(a.isLastNode){y=l[s].length-1;E=l[s][y-1];E.isLastNode=true}else{for(N=0,m=l[s].length;N<m;N++){if(l[s][N].tId==a.tId){y=N;break}}}if(y>=0){l[s].splice(y,1)}if(o!=h.move.TYPE_INNER){for(N=0,m=u[s].length;N<m;N++){if(u[s][N].tId==n.tId)b=N}}if(o==h.move.TYPE_INNER){if(!n[s])n[s]=new Array;if(n[s].length>0){C=n[s][n[s].length-1];C.isLastNode=false}n[s].splice(n[s].length,0,a);a.isLastNode=true;a.isFirstNode=n[s].length==1}else if(n.isFirstNode&&o==h.move.TYPE_PREV){u[s].splice(b,0,a);C=n;C.isFirstNode=false;a.parentTId=n.parentTId;a.isFirstNode=true;a.isLastNode=false}else if(n.isLastNode&&o==h.move.TYPE_NEXT){u[s].splice(b+1,0,a);C=n;C.isLastNode=false;a.parentTId=n.parentTId;a.isFirstNode=false;a.isLastNode=true}else{if(o==h.move.TYPE_PREV){u[s].splice(b,0,a)}else{u[s].splice(b+1,0,a)}a.parentTId=n.parentTId;a.isFirstNode=false;a.isLastNode=false}T.fixPIdKeyValue(t,a);T.setSonNodeLevel(t,a.getParentNode(),a);I.setNodeLineIcos(t,a);I.repairNodeLevelClass(t,a,w);if(!t.data.keep.parent&&l[s].length<1){l.isParent=false;l.open=false;var k=e("#"+l.tId+h.id.UL),P=e("#"+l.tId+h.id.SWITCH),O=e("#"+l.tId+h.id.ICON);I.replaceSwitchClass(l,P,h.folder.DOCU);I.replaceIcoClass(l,O,h.folder.DOCU);k.css("display","none")}else if(E){I.setNodeLineIcos(t,E)}if(C){I.setNodeLineIcos(t,C)}if(!!t.check&&t.check.enable&&I.repairChkClass){I.repairChkClass(t,l);I.repairParentChkClassWithSelf(t,l);if(l!=a.parent)I.repairParentChkClassWithSelf(t,a)}if(!i){I.expandCollapseParentNode(t,a.getParentNode(),true,r)}},removeEditBtn:function(t){e("#"+t.tId+h.id.EDIT).unbind().remove()},removeRemoveBtn:function(t){e("#"+t.tId+h.id.REMOVE).unbind().remove()},removeTreeDom:function(e,t){t.isHover=false;I.removeEditBtn(t);I.removeRemoveBtn(t);m.apply(e.view.removeHoverDom,[e.treeId,t])},repairNodeLevelClass:function(t,n,a){if(a===n.level)return;var o=e("#"+n.tId),r=e("#"+n.tId+h.id.A),i=e("#"+n.tId+h.id.UL),d=h.className.LEVEL+a,s=h.className.LEVEL+n.level;o.removeClass(d);o.addClass(s);r.removeClass(d);r.addClass(s);i.removeClass(d);i.addClass(s)}},v={tools:p,view:g,event:u,data:c};e.extend(true,e.fn.zTree.consts,t);e.extend(true,e.fn.zTree._z,v);var N=e.fn.zTree,m=N._z.tools,h=N.consts,I=N._z.view,T=N._z.data,y=N._z.event;T.exSetting(n);T.addInitBind(r);T.addInitUnBind(i);T.addInitCache(o);T.addInitNode(s);T.addInitProxy(d);T.addInitRoot(a);T.addZTreeTools(l);var b=I.cancelPreSelectedNode;I.cancelPreSelectedNode=function(e,t){var n=T.getRoot(e).curSelectedList;for(var a=0,o=n.length;a<o;a++){if(!t||t===n[a]){I.removeTreeDom(e,n[a]);if(t)break}}if(b)b.apply(I,arguments)};var E=I.createNodes;I.createNodes=function(e,t,n,a){if(E){E.apply(I,arguments)}if(!n)return;if(I.repairParentChkClassWithSelf){I.repairParentChkClassWithSelf(e,a)}};var C=I.makeNodeUrl;I.makeNodeUrl=function(e,t){return e.edit.enable?null:C.apply(I,arguments)};var w=I.removeNode;I.removeNode=function(e,t){var n=T.getRoot(e);if(n.curEditNode===t)n.curEditNode=null;if(w){w.apply(I,arguments)}};var k=I.selectNode;I.selectNode=function(e,t,n){var a=T.getRoot(e);if(T.isSelectedNode(e,t)&&a.curEditNode==t&&t.editNameFlag){return false}if(k)k.apply(I,arguments);I.addHoverDom(e,t);return true};var P=m.uCanDo;m.uCanDo=function(e,t){var n=T.getRoot(e);if(t&&(m.eqs(t.type,"mouseover")||m.eqs(t.type,"mouseout")||m.eqs(t.type,"mousedown")||m.eqs(t.type,"mouseup"))){return true}return!n.curEditNode&&(P?P.apply(I,arguments):true)}})(jQuery);